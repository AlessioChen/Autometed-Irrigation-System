{% extends 'plant/base.html' %} 
{% block content %} 

<div class="container">
    <div class="row">
        <div class="col-md-3 col-xs-6">
            <h3>SOIL HUMIDITY</h3>
            <canvas id="SHChart" width="400" height="400"></canvas>
        </div>
        <div class="col-md-3 col-xs-6">
            <h3>ENGINE ACTIVITY</h3>
            <canvas id="EAChart" width="400" height="400"></canvas>

        </div>
        <div class="col-md-3 col-xs-6">
            <h3>AIR HUMIDITY</h3>
            <canvas id="AHChart" width="400" height="400"></canvas>

        </div>
        <div class="col-md-3 col-xs-6">
            <h3>AIR TEMPERATURE</h3>
            <canvas id="ATChart" width="400" height="400"></canvas>
        </div>
    </div>

    <hr>

</div>

{% endblock %}


{% block scripts %}

<script>
    function updateSensors() {
        $.ajax({
            url: "{% url 'update_sensors' %}",
            success: function(response) {
                //JSON.parse converts strings into javascripts object
                air_humidity = JSON.parse(['air_humidity']);
                soil_humidity = JSON.parse(['soil_humidity']);
                air_temperature = JSON.parse(['air_temperature']);


                updateData(SHChart, [soil_humidity, 100 - soil_humidity]);
                updateData(AHChart, [air_humidity, 100 - air_humidity]);
                updateData(ATChart, [air_temperature, 40 - air_humidity]);


            }
        });
        setTimeout(updateSensors, 1000);
    }

    $(document).ready(function() {
        // run the first time; all subsequent calls will take care of themselves
        //setTimeout(updateSensors, 1000);
    });
</script>

<script>
    function updateData(chart, data) {
        chart.data.datasets[0].data = data;
        chart.update();

    };
</script>


<script>
    var ctx = document.getElementById('SHChart').getContext('2d');
    var SHChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            datasets: [{
                label: '# of Votes',
                data: [60, 40],
                backgroundColor: [
                    'rgba(255, 204, 102, 1)',
                    'rgba(255, 204, 102, 0.2)'
                ],
                borderColor: [
                    'rgba(255, 204, 102, 1)',
                    'rgba(255, 204, 102, 0.2)'
                ],
                borderWidth: 1
            }]
        },
        options: {}
    });
</script>


<script>
    var ctx = document.getElementById('EAChart').getContext('2d');
    var EAChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            datasets: [{
                label: '# of Votes',
                data: [30, 70],
                backgroundColor: [
                    'rgba(100, 255, 100, 1)',
                    'rgba(100, 255, 100, 0.2)'
                ],
                borderColor: [
                    'rgba(100, 255, 100, 1)',
                    'rgba(100, 255, 100, 0.2)'
                ],
                borderWidth: 1
            }]
        },
        options: {}
    });
</script>


<script>
    var ctx = document.getElementById('AHChart').getContext('2d');
    var AHChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            datasets: [{
                label: '# of Votes',
                data: [40, 60],
                backgroundColor: [
                    'rgba(102, 102, 255, 1)',
                    'rgba(102, 102, 255, 0.2)'
                ],
                borderColor: [
                    'rgba(102, 102, 255, 1)',
                    'rgba(102, 102, 255, 0.2)'
                ],
                borderWidth: 1
            }]
        },
        options: {}
    });
</script>



<script>
    var ctx = document.getElementById('ATChart').getContext('2d');
    var ATChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            datasets: [{
                label: '# of Votes',
                data: [20, 80],
                backgroundColor: [
                    'rgba(255, 102, 102, 1)',
                    'rgba(255, 102, 102, 0.2)'
                ],
                borderColor: [
                    'rgba(255, 102, 102, 1)',
                    'rgba(255, 102, 102, 0.2)'
                ],
                borderWidth: 1
            }]
        },
        options: {}
    });
</script>
{% endblock %}
